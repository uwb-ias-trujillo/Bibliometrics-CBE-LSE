---
title: "CBE-LSE Bibliometric Analysis"
author: "Caleb Trujillo, Darcie Nelson, Rachel Kudlacz, Germaine Ng"
date: "`r Sys.Date()`"
output:
  html_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
require("devtools")
require("rgexf")
require("bibliometrix")
require("igraph")
require("tidyverse")
require("xtable")
require("sf")
require("ggrepel")
require("ggraph")
require("ggthemes")
require("rcartocolor")
require("ggpubr")
devtools::install_github("massimoaria/bibliometrix")

devtools::install_github("wmurphyrd/fiftystater")
devtools::install_github("UrbanInstitute/urbnmapr")
library(urbnmapr)
library(bibliometrix)
library(tidyverse)
library(networkD3)
library(rcartocolor)
library(rgexf)
library(igraph)
library(xtable)
library(readxl)
library(scales)
library(ggplot2)
library("fiftystater")
library(sf)
library(readxl)
library(ggthemes)
library(ggpubr)
library(RColorBrewer)

# source('functions.r')
```

## Introduction

There has been tremendous growth in the area of undergraduate biology research over the last fifteen years. This study attempts to summarize and analyze the progress of this growth for the journal of *CBE-LSE*. 

### Summary of initial data set

```{r dataset}
txt <- c("rawdata/CBE-LSE-2008-June2022/CBE-LSE-2008-June2022.txt")
data <- convert2df(file = txt, dbsource = 'wos', format = "plaintext")
results <- biblioAnalysis(data, sep = ";")

theme_default <- theme(
    plot.caption = element_text(hjust = 0, face= "italic"),
    plot.title.position = "plot",
    plot.caption.position = "plot",
    panel.background = element_rect(fill = "white"),
    panel.grid = element_line(size = .25, color = "#99CCCC"),
    axis.ticks = element_blank(),
    legend.key = element_rect(color = "#F2F2F2"),
    legend.background = element_rect(fill = "white"),
    legend.position = "top",
    plot.background = element_rect(fill = "white")
    )
```

After the results are processed, they are stored as data tables for information reporting. 

```{r biblio}
options(width=100)

S <- summary(object = results, pause = FALSE)
S
#plot(x=results, k=10, pause=F)
S$MainInformationDF

dir.create("tables")
write.csv(file = "tables/keywords.csv",as.data.frame(results$ID[1:20]))

write.csv(file = "tables/Maininformation.csv",S$MainInformationDF)

write.csv(file = "tables/ArticlesYears.csv",S$AnnualProduction)

write.csv(file = "tables/MostCitedPapers.csv",S$MostCitedPapers)

write.csv(file = "tables/MostProdAuthors.csv", S$MostProdAuthors)

write.csv(file = "tables/Universities.csv", results$Affiliations)
```
## Research Questions

### Basic overview of the field

```{r overview, skip = TRUE}
colnames(S$AnnualProduction) <- make.names(colnames(S$AnnualProduction))

ggplot(data = S$AnnualProduction, mapping = aes(x = Year..., y = Articles, group = 1)) +
  geom_line(stat = "identity", color = "#266b6e", size = 1.5) + 
  geom_line(data = data.frame(x = as.factor(c(2021,2022)), y = c(74,40 + 25 + 20)), aes(x,y), linetype = 6, stat = "identity", color = "#1d4f60", size = 1, #alpha = 0.8
            ) + # added projected articles.
  #theme_dark() +
  scale_x_discrete(breaks = function(x){x[c(TRUE, FALSE)]}) +
  theme_default +
  theme(panel.grid.major.x = element_blank(),panel.grid.minor = element_blank(),panel.grid.major.y = element_line(size = 0.2))+
  labs(
    title = "Articles published per year",
    x = NULL,
    y = NULL,
  )
ggsave("figures/AnnualProductivity.jpg", device = "jpeg", dpi = 400)

```


## Authoring

```{r author productivity}

S$MostProdAuthors 

authors=gsub(","," ",names(results$Authors))
indices <- Hindex(data, field = "author", elements = authors, sep = ";", years = Inf)

indices$H %>%
  dplyr::arrange(desc(NP))

as_tibble(results$Authors)

authordata <- dplyr::inner_join(tibble::as_tibble(results$Authors),indices$H, by = c("AU" = "Element")) %>%
  filter("n" > 5) #only showing authors with at least 5 publications.


authorprod <- authorProdOverTime(data, k = 10, graph = TRUE)$graph + 
  labs(title = "Author productivity from 2008 - 2022", x = NULL, y = NULL) + 
  theme_minimal() +
  theme(plot.title.position = "plot",
        panel.grid.major.y = element_blank(),
        legend.title = element_text(),
        axis.text.y = element_text(margin = margin(r = -0.05, l = 0.3, unit = "in")))

authorprod
ggsave("figures/AuthorProd.jpg", device = "jpeg", dpi = 400, width = 7, height = 5, units = "in", bg = "white", limitsize = FALSE)


authordata %>%
  filter(n > 8) %>%
ggplot(aes( x = NP, y = h_index)) + 
  geom_point(alpha = 0.6) +
  geom_label_repel(aes(label = AU), size = 2,  box.padding = 0.001, min.segment.length = 0.01) +
  #theme_dark() +
  theme_default +
  labs(y = "h—index",
       x = "Publications",
       caption = "CBE — Life Science Education") +
  coord_flip() +
  ggtitle("Author productivity", subtitle = "Number of publications and h-index for LSE authors between 2010 and 2021")

authordata %>%
  filter(n > 8) %>%
ggplot(aes(x = reorder(AU, (NP)), y = NP)) + 
  geom_col(alpha = 1) +
  #geom_label_repel(aes(label = AU), size = 2, box.padding = 0.001, min.segment.length = 0.01)  +
  #theme_minimal()+
  theme_default +
  labs(y = NULL,
       x = NULL,
       caption = "CBE — Life Science Education between 2010 and 2021") +
  coord_flip() +
  theme(axis.text.y = element_text(size = 8),
        panel.grid.major.y = element_blank(),
        #panel.grid.major.x = element_blank(),
        #panel.grid.minor.x = element_blank(),
        legend.position = 'none') +
  ggtitle("Author productivity", subtitle = "Number of publications by LSE authors")

# Add color for school type using the other graph to depict these. 
# Going to use full join between data on author productivity and their affiliation (university or institution). 
```

### Affiliations around the world

```{r world affiliations, echo=FALSE}

world_map = map_data("world") %>% 
  filter(! long > 180)

countries <- world_map %>% 
  distinct(region) %>% 
  rowid_to_column()

countryfreq <- results$Countries %>%
  as.data.frame() %>%
  mutate(Tab = str_to_title(Tab)) %>% 
  mutate(Tab = case_when(
    Tab == "Usa" ~ "USA",
    Tab == "United Kingdom" ~"UK",
    TRUE ~ Tab
  )) 

AffiliationWorldMap <- countries %>%
  full_join(countryfreq, by = c("region" = "Tab")) %>% 
  ggplot(aes(fill = Freq, map_id = region), color = 1) +
  #geom_hline(yintercept=0, color = "light grey") +
  geom_map(map = world_map, colour = "white", lwd = 0.2) +
  expand_limits(x = world_map$long, y = world_map$lat) +
  coord_map("moll") +
  #coord_quickmap()+
  theme_map()+
  #theme_default +
  #labs(caption = "") +
  theme(#plot.margin= unit(c(0.5, 0.5, 0.5, 0.5), "cm"),
        # plot.caption = element_text(hjust = 0, face= "italic"),
        # plot.title.position = "plot",
        # plot.caption.position =  "plot",
        legend.title = element_blank(),
        panel.background = element_rect(fill = "lightblue", color = "lightblue"),
        legend.position = c(0.03, 0.06),
        legend.background = element_rect(fill = NA),
        legend.direction = "vertical",
        #legend.key.size = unit(0.4, "cm"),
        legend.key.height= unit(.5, 'cm'),
        legend.key.width= unit(.5, 'cm'),
        #plot.caption.position = "plot",
        #plot.caption = element_text(hjust = 0)
        #legend.margin = margin(6, 12, 4, 1)
        #legend.position = "left"
        ) +
  scale_fill_carto_c(palette = "BluGrn", direction = 1,
                       trans = scales::pseudo_log_trans(sigma = 0.01),
                       breaks = c(1,10, 100, 1000),
                       labels = c(1,10, 100, 1000),
                       limits = c(1,1000)
  ) +
  labs(fill = "Count of article",
       title = "Articles by author's country affiliation",
    x = NULL,
    y = NULL
    ) 

AffiliationWorldMap
ggsave("figures/AffiliationWorldMap.jpg", device = "jpeg", dpi = 400,  width = 7,
  height = 3,
  units = "in", limitsize = FALSE)
```

### Affiliations in the US

```{r US affiliations}
#Affiliation Map - US
#Joining files
msidata <- read_excel("rawdata/2020eligibilitymatrix.xlsx", 
    skip = 10)

affiliations <- read_excel("tables/UnivIndex.xlsx")

msiuniv <- left_join(affiliations, msidata) %>%
  filter(OPEID != "NA")

#Tables
msistates <- msiuniv %>%
  group_by(St) %>%
  summarize(n = n(), articles = sum(Freq) ) %>%
  #filter(!(St %in% c("MH", "PR", "VI", "GU"))) %>% 
  rename(states = St, affiliations = n) %>%
  group_by(affiliations, articles)
view(msistates)

msistates$state_name <- state.name[match(msistates$states,state.abb)]

us <- fortify(map_data("state"), region = "region") %>%
  mutate(region = str_to_title(region))
spatial_data <- right_join(msistates,
                          us,
                          by = c("state_name" ="region"))

affiliationMap <- ggplot() +
  geom_map(data  =  spatial_data, map = us,
             aes(x = long, y = lat, map_id = state_name, group = group, fill = affiliations, label = states),
             color = "black", size = 0.25) +
  coord_map("albers", lat0 = 39, lat1 = 45) +
  theme_map() +
  theme_default +
  scale_fill_viridis_c(option = "E", 
                       direction = -1)+
  labs(fill = "Author affiliations",
       title = "Number of author affilitations by state",
       x = NULL,
       y = NULL) +
  theme(plot.margin = unit(c(1,1,1,1), "cm"),
        panel.background = element_blank())

ggsave("figures/AffiliationUSMap.jpg", device = "jpeg", dpi = 400,  width = 7,
  height = 5,
  units = "in", limitsize = FALSE)


centroids <- spatial_data %>%
  group_by(state_name, articles) %>%
  summarise(latitude = exp(mean(log(lat))), longitude = exp(mean(log(long))))

#Article Map 
ArticlesUSMap <- ggplot() +
  geom_map(data  =  spatial_data, map = us,
           aes(x = long, y = lat, map_id = state_name, group = group, fill = articles, label = states),
             color = "white", size = 0.25) +
  coord_map("moll") +
  theme_map() +
  labs(fill = "Publications",
       title = "Articles by author's state affiliation",
       caption = "DC: 23, PR: 11, HI: 6, AK: 3, VI: 2, GU: 1, MH: 1.\nCounts are summarized by state/territory of each article by each author's affiliation.",
    x = NULL,
    y = NULL
    ) +
  scale_fill_carto_c(palette = "BluGrn", direction = 1) +
  theme(#plot.margin = unit(c(-2,0,0,0), "cm"),
        panel.background = element_blank(),
        legend.background = element_blank(),
        legend.direction = "vertical",
        legend.title=element_blank(),
        legend.key.height= unit(.5, 'cm'),
        legend.key.width= unit(.5, 'cm'),
        plot.caption.position = "plot",
        plot.caption = element_text(hjust = 0)
        #legend.position = "top"
        )

ArticlesUSMap
ggsave("figures/ArticlesUSMap.jpg",
       device = "jpeg", dpi = 400,
       width = 7, height = 4,
       units = "in", limitsize = FALSE)
```

```{r combining maps}
ggarrange(AffiliationWorldMap, ArticlesUSMap, legend = "right", ncol = 1, nrow = 2, align = c("hv"))
ggsave("figures/WorldUSMap.jpg",
       device = "jpeg", dpi = 400,
       width = 7, height = 8,
       units = "in", bg = "white", limitsize = FALSE)

```

```{r MSI, echo=FALSE}
msiuniv$`Eligible/ Current Grant` <- as.factor(msiuniv$`Eligible/ Current Grant`)

msieligible <- msiuniv %>%
  group_by(`Eligible/ Current Grant`) %>%
  summarize(n = n())

msiuniv$`Type & Control` <- as.factor(msiuniv$`Type & Control`)

msitype <- msiuniv %>%
  group_by(`Type & Control`) %>%
  summarize(n = n()) %>%
  mutate(percent = (n/sum(n)))

msitypeall <- msidata %>%
  group_by(`Type & Control`) %>%
  summarize(n = n()) %>%
  mutate(percent = (n/sum(n)))

types <- left_join(msitypeall,msitype, by = "Type & Control")
colnames(types)<- c("SchoolType", "Number of Insitutions in US", "US", "Number of Institutes in LSE", "LSE")
types$SchoolType <- recode(types$SchoolType, "Pri 2yr" = "Private 2-year", "Pri 4yr" = "Private 4-year","Pub 2yr" = "Public 2-year", "Pub 4yr" = "Public 4-year") 
view(types)

#We try to compare the percentage breakdown of institutions in the US according to the MSI eligibility matrix to amount in the LSE affiliations list.
types %>%
  pivot_longer(!SchoolType) %>%
  filter(name == "US" | name == "LSE") %>%
  filter(SchoolType != FALSE) %>%
  mutate(colorlevel = case_when(
      name == "US" ~ 0.9,
      name == "LSE" ~ 0.7)) %>%
  ggplot(aes(x = (name),value)) +
  geom_col(aes(fill = SchoolType, color = as.numeric(colorlevel)), 
           size = 4) +
  geom_text(aes(label = paste0(round(value*100, 0),"%")),
            vjust = 0.5, nudge_y = -.04,
            size = 3, fontface = "bold") +
  theme_default +
  theme(legend.position="none", 
        strip.background = element_rect(fill = "#F2F2F2"),
        #panel.grid.major.x = element_blank(),
        axis.text = element_text(size = 10)
        ) +
  scale_color_identity(guide = "none") +
  scale_y_continuous(minor_breaks = NULL,
                     labels = scales::percent) +
  labs(x = NULL, y = NULL,
       title = "What types of institutions are represented in LSE?"
       ) +
  facet_wrap(~SchoolType, nrow = 2) +
  theme(panel.spacing.y = unit(1, "lines"),
        axis.text.y = element_text(margin = margin(l = 0.2, unit = "in")),
        strip.text.x = element_text(size = 11),
        strip.background = element_rect(fill = "white"),
        plot.margin = margin(t = .25, r = .25, b = .25, l = .1, unit = "in"))

ggsave("figures/SchoolTypes.jpg", device = "jpeg", dpi = 400,  width = 7,
  height = 5,
  units = "in", limitsize = FALSE)

```


```{r MSI cont}
temp <- msiuniv %>%
  mutate_if(is.numeric,as.factor)%>%
  mutate_if(is.character,as.factor)%>%
  select(`Institution Name`,`AANAPISI`, `AANAPISI F`,`ANNH`,`ANNH F`,`HBCU`,`HBCU Masters`, HBGI,HSI,`HSI STEM`,NASNTI, `NASNTI F` ,`PBI F`,`PBI A`,PPOHA,SIP,TCCU) %>%
  pivot_longer(cols = !`Institution Name`) %>%
  mutate(eligibility = if_else(value == 1 | value == 2| value == 3, "Ineligible", "NA")) %>%
  mutate(eligibility = if_else(value == 4 | value == '4R' |value == 5 | value == '5R', "Eligible or potentially eligible", eligibility))%>%
  mutate(eligibility = if_else(value == 6, "Current grantee", eligibility)) %>%
  mutate(eligibility = if_else(value == 0, "Undetermined", eligibility)) %>%
  group_by(name,eligibility)%>%
  summarize(n=n())%>%
  mutate(perc = round(n/sum(n),3))

msisummary_n <- temp%>%
  select(!perc)%>%
  pivot_wider(names_from = name, values_from = c(n))
view(msisummary_n)

msisummary_perc <- temp%>%
  select(!n)%>%
  mutate(perc = label_percent()(perc)) %>% 
  pivot_wider(names_from = name, values_from = c(perc))
view(msisummary_perc)

temp %>%
  filter(eligibility == "Current grantee") %>%
  arrange(perc, "desc") %>% 
  mutate(name = reorder(as.factor(name), desc(perc)), order = (perc)) %>%
  pull(name)-> x_levels

temp$name<- factor(x = temp$name, levels = (x_levels))

MSIAffiliationPlot <- temp %>% 
  filter(#eligibility != "Ineligible" &
    eligibility != "Undetermined", !is.na(name)) %>%
  ggplot(aes(x = name, y = perc, fill = eligibility)) +
  geom_col(position = position_stack(reverse = TRUE)) +
  scale_y_continuous(labels = scales::percent) +
  coord_flip() +
  #theme_dark() +
  #scale_fill_manual(values = c("#F26E50", "#F2A679", "#F2D6B9")) +
  #scale_fill_viridis(discrete = TRUE, option = "F") +
  scale_fill_manual(values = c("#1d4f60", "#4da284", "lightblue")) +
 #scale_fill_carto_d(palette = "BluGrn", direction = -1) +
  
  #c4e6c3,#96d2a4,#6dbc90,#4da284,#36877a,#266b6e,#1d4f60
  
  theme_default + 
  labs(
    title = "US Author affiliations by Minority Serving Institution status",
    y = NULL, 
    x = NULL
  )  +
  theme(legend.title = element_blank(),
        legend.position = "bottom",
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        axis.text.y = element_text(margin = margin(r = -0.5, l = 0.4, unit = "cm")),
       )

MSIAffiliationPlot
ggsave("figures/MsiAffiliations.jpg",
       device = "jpeg", dpi = 400,
       width = 7, height = 4,
       units = "in", limitsize = FALSE)

#mutate(status = if_else(value == TRUE, "Eligible or current grantee",  NA, status ==                     if_else(value == FALSE,"Not eligible or potentially eligible", NA)))
```

### What are the collaborative connections between institutions?

```{r top 10 affiliations}
Affiliation <- results$Affiliations[1:10]
Affiliation <- as.data.frame(Affiliation) %>%
  mutate(
    color = case_when(
      row_number() == 1 ~ "goldenrod1",
      row_number() == 2 ~ "lightgreen",
      row_number() == 3 ~ "coral2",
      ## all others should be gray
      TRUE ~ "gray75"
    ))

#Author affiliations
ggplot(Affiliation,aes(x = reorder(str_to_title(AFF), Freq), y = Freq)) +  
  geom_col(aes(fill = color)) +
  geom_text(
    aes(label = reorder(str_to_title(AFF), Freq), y=0.13),
     hjust = 0, nudge_y = .5,
     size = 3.5, fontface = "bold", #family = "Fira Sans",
    fill = "white", label.size = 0
  ) +
  geom_text(
    aes(label = Freq),
     hjust = 0, nudge_y = .5,
     size = 3.5, fontface = "bold", #family = "Fira Sans"
  ) +
  coord_flip() +
  theme_default +
  labs(
    x = NULL,
    y = NULL,
    title = "Top 10 author affiliations",
  )+
  scale_fill_identity(guide = "none") +
  scale_x_discrete(labels = NULL)+ 
  scale_y_continuous(labels = NULL)+
  theme(panel.grid.major.y = element_blank(),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(),
        legend.position = 'none',
        )

ggsave("figures/AffliationsTop10.jpg", 
       device = "jpeg", dpi = 400,
       width = 7, height = 4,
       units = "in", limitsize = FALSE
       )
```

### Most cited papers and journals
```{r citations, echo=FALSE}
CR <- citations(data, field = "article", sep = ";")
CRtable <-cbind(CR$Cited[1:20])
CRtable

write.csv(file = "Citations.csv",CR2table)

# Sources Table
sourcestable <-cbind(summary(factor(CR$Source))[1:10])
sourcestable

write.csv(file = "Sources.csv",sourcestable)
```



### Multiple Correspondence Analysis

```{r topics and keywords}
# Show how key words appear together using Multiple Correspondence Analysis
#Consider selecting only articles that have the keywords  associated 
CS30 <- bibliometrix::conceptualStructure(data, 
                          field ="ID", 
                          ngrams = 1, 
                          method = "MCA", 
                          minDegree= 30,
                          clust= "3", 
                          k.max=5, 
                          stemming= FALSE, 
                          labelsize=10, 
                          documents=10
                          )

CS19 <- bibliometrix::conceptualStructure(data, 
                          field ="ID", 
                          ngrams = 1, 
                          method = "MCA", 
                          minDegree= 19,
                          clust= "3", 
                          k.max=5, 
                          stemming= FALSE, 
                          labelsize=10, 
                          documents=10
                          )


ggsave("figures/CS30ConceptualStructure.png", plot = CS30$graph_terms, device = "png")

ggsave("figures/CS30ConceptualCluster.png", plot = CS30$graph_dendogram + coord_flip(), device = "png")

ggsave("figures/19ConceptualStructure.png", plot = CS19$graph_terms, device = "png")

ggsave("figures/19ConceptualCluster.png", plot = CS19$graph_dendogram + coord_flip(), device = "png")
```


```{r title topics}
hypened<-results$ID[results$ID>10] %>%
  row.names()%>%
  str_detect("-") 
spaced<- results$ID[results$ID>10] %>%
  row.names()%>%
  str_detect(" ")
compound<-results$ID[results$ID>10][hypened|spaced]%>%
  row.names()

compound <- compound[!compound %in% "UNDERGRADUATE RESEARCH EXPERIENCES"]
  
TitleTerms <- termExtraction(data, "TI",stemming = TRUE, keep.terms = compound) %>%
KeywordGrowth(Tag= "TI_TM", top = 1000) %>%
  pivot_longer(cols = !c('Year')) %>%
  group_by(Year) %>%
  mutate(sum = sum(value), perc = value / sum) %>%
  filter(value > 1) %>%
  filter(perc > 0.005)

SharedTerms <- TitleTerms %>%
  #select(Year,name) %>%
  group_by(name) %>%
  summarize(total = n()) %>%
  filter(total > 2)

TopTerms<- TitleTerms %>% 
  filter(name %in% SharedTerms$name) %>%
  group_by(Year) %>%
  arrange(value, .by_group = TRUE) %>%
  top_n(15)

TitleText <- TitleTerms %>%
  group_by(name) %>%
  top_n(1, Year) %>%
  filter(name %in% SharedTerms$name)

TitleTerms %>% 
  filter(name %in% TopTerms$name) %>%
  ggplot(aes(Year, perc, group = name, color=name, fill=name, label = name))+
  geom_line() + 
  geom_text_repel(aes(label = name), data = . %>% group_by(name) %>% top_n(1, Year), 
                  size = 2, 
                  color = "black",
                  arrow = arrow(length = unit(0.02, "npc")),
                  box.padding = 0.5
                  )# + 
  #scale_y_log10(labels = label_percent()) + 
  
  #theme_default +
  labs(title = "Conceptual trends based on article titles")+
  theme(legend.position="none")

ggsave("figures/TitleLineTrends.png", device = "png", dpi = 400,
       width = 7, height = 7,
       units = "in")


TitleTerms %>% 
  filter(name %in% TopTerms$name) %>%
  ggplot(aes(x=reorder(as.factor(str_to_sentence(name)),cumsum(value)),y = Year, group = name, color=name, fill=name, label = name, size = perc), alpha = 0.3)+
  #geom_violin(alpha = 0.3)+
  #geom_point() +
  #geom_line(alpha = 0.8, size = 0.5)+
  geom_violin(aes(scale = perc))+
  geom_text(aes(label = str_to_sentence(name)), data = . %>% group_by(name) %>% top_n(-1, Year), #%>% filter(Year > 2012), 
                  size = 2, 
                  color = "black",
                  #arrow = arrow(length = unit(0.02, "npc")),
                  #box.padding = 0.5
                  nudge_x = 0,hjust = -0)+
  scale_y_continuous(labels = label_date(format = "%y")) +
  scale_x_discrete()+
  coord_flip ()+
  theme_default +
  labs(title = "Conceptual trends based on article titles", y = NULL, x = NULL, )+
  theme(legend.position="none",
        axis.text.y = element_blank())

ggsave("figures/TitleTrends.png", width = 4, height = 7, device = "png")
```


```{r topics and keywords}
CS2 <- termExtraction(data, "TI",stemming = FALSE, keep.terms = compound) %>%
  conceptualStructure(field ="TI_TM", 
                          ngrams = 1, 
                          method = "MCA",
                          quali.supp = NULL,
                          quanti.supp = NULL,
                          minDegree= 50,
                          clust= "auto", 
                          k.max=5, 
                          stemming= FALSE, 
                          labelsize=10, 
                          documents=2)

ggsave("figures/ConceptualStructure2.png", plot = CS2$graph_terms, device = "png")


ggsave("figures/ConceptualCluster2.png", plot = CS2$graph_dendogram + coord_flip(), device = "png")
```
